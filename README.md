# Document recognition for NTI
# Использование
## Запуск
Склонируйте репозиторий, установите библиотеки из requirements.txt и введите команду вида:
```
python total.py -p path/to/image_folder
```
Опциональный аргумент -t принимает значения 0/1. При значении 1 включает секундомер и в конце исполнения программы выводит среднее время обработки 1 документа.
## Формат входных данных
Скрипт работает со всеми(3) видами документов и определяет их автоматически.  
На вход принимается дирректория с файлами.  
Поддерживаются .png, .jpg и .pdf
## Формат выходных данных
Для каждой обработанной картинки скрипт возвращает строку вида:  
Для правильного документа:
```
DocumentName.*** True
```
Для неправильного документа:
```
DocumentName.*** False
```
## Пример из коробки
```
python total.py -p Tests
```
## Примечание
Для обработки pdf может понадобится установка дополнительного по, однако при тестировании на linux дополнительные установки не понадобились.  
В случае возникновения проблемы, можете обратиться к readme по ссылке: https://github.com/Belval/pdf2image
# Валидация
Документ считается валидным(правильным) в случае если он:  
1) Принадлежит одному из 3 предоставленных шаблонов([до 14 лет](https://drive.google.com/file/d/1tj7hxhrnC9MAcHFFAvaugQrclcvCBptS/view), [от 14 до 18](https://drive.google.com/file/d/17jdyFcY1D7s4m7XHZfpKDEdZdWJq03nt/view), [согласие на обработку](https://drive.google.com/file/d/1n7wJ1dM3uov8wTY_y5g6I_n7rUEOd9BB/view))
2) Заполнен, т.е во всех полях для текста есть текст. 
    
* В случае с документом от 14 до 18 лет достаточно, чтобы из строк "свидетельство о регистрации рождения...." и следующей за ней была заполнена только одна, так как они являются взаимозаменяющими
# Тестирование
Тестирование проводилось на linux, ryzen 7, 8гб ОЗУ, среднее время обработки 1 документа -- 0.55 сек.  
После публикации тестовых данных время исполнения может быть понижено за счёт отброса лишних функций, которые могут обнаружиться при большом тестировании. 


# Алгоритм
1) Документ приводится к стандартному виду. Для этого:  
    1.1) Убираются шумы  
    1.2) Документ поварачивается(угол находится по отклонению блока текста)  
    1.3) Документ обрезается  
2) При помощи классификации заголовка определяется тип документа  
3) В приведённом к стандартному виду документе проверяются зоны для текста  
4) Если до этого момента документ не был отброшен по какой либо из причин и все зоны заполнены, документ считается правильным  

# Про добавление новых форматов документов
Сейчас зоны(п.3 Алгоритма) для заполнения(их координаты на документе) прописываются в ручную, однако для этого сделан удобный интерфейс(администратор выделаяет зоны мышкой на картинке) и весь процесс занимает не дольше 5 минут.  
В будущем можно:  
    А) Доделать интерфейс, чтобы им мог пользоваться администратор  
    Б) Попробовать автоматизировать процесс для минимизации вмешательства администратора.
